---
title: OIDC Provider
description: Open ID Connect plugin for Better Auth that allows you to have your own OIDC provider.
---

The **OIDC Provider Plugin** enables you to build and manage your own OpenID Connect (OIDC) provider, granting full control over user authentication without relying on third-party services like Okta or Azure AD. It also allows other services to authenticate users through your OIDC provider.

**Key Features**:

- **Client Registration**: Register clients to authenticate with your OIDC provider.
- **Authorization Code Flow**: Support the Authorization Code Flow.
- **JWKS Endpoint**: Publish a JWKS endpoint to allow clients to verify tokens.
- **Refresh Tokens**: Issue refresh tokens and handle access token renewal using the `refresh_token` grant.
- **OAuth Consent**: Implement OAuth consent screens for user authorization, with an option to bypass consent for trusted applications.
- **UserInfo Endpoint**: Provide a UserInfo endpoint for clients to retrieve user details.

<Callout type="warn">
This plugin is in active development and may not be suitable for production use. Please report any issues or bugs on [GitHub](
https://github.com/better-auth/better-auth
).
</Callout>

## Installation

<Steps>
    <Step>
        ### Mount the Plugin

        Add the OIDC plugin to your auth config. See [OIDC Configuration](#oidc-configuration) on how to configure the plugin.

        ```ts title="auth.ts"
        import { betterAuth } from "better-auth";
        import { oidcProvider } from "better-auth/plugins/oidc-provider";

        const auth = betterAuth({
            plugins: [oidcProvider({
                // Your OIDC configuration
            })]
        })
        ```
    </Step>

    <Step>
        ### Migrate the Database

        Run the migration or generate the schema to add the necessary fields and tables to the database.

        <Tabs items={["migrate", "generate"]}>
            <Tab value="migrate">
            ```bash
            npx @better-auth/cli migrate
            ```
            </Tab>
            <Tab value="generate">
            ```bash
            npx @better-auth/cli generate
            ```
            </Tab>
        </Tabs>
        See the [Schema](#schema) section to add the fields manually.
    </Step>

    <Step>
        ### Add the Client Plugin

        Add the OIDC client plugin to your auth client config.

        ```ts
        import { createAuthClient } from "better-auth/client";
        import { oidcClient } from "better-auth/client/plugins"
        const authClient = createAuthClient({
            plugins: [oidcClient({
                // Your OIDC configuration
            })]
        })
        ```
    </Step>
</Steps>

## Usage

Once installed, you can utilize the OIDC Provider to manage authentication flows within your application.

### Register an OIDC Client

To register a new OIDC client, use the `registerOAuth2Client` endpoint with the necessary configuration details.

```ts title="auth.ts"
await auth.api.registerOAuth2Client({
    name: "My Client",
    redirectURLs: ["https://client.example.com/callback"],
});
```

### Authorization Code Flow

Initiate the Authorization Code Flow by directing users to the authorization endpoint.

```ts title="auth.ts"
const authorizationURL = `${baseURL}/oauth2/authorize?response_type=code&client_id=your_client_id&redirect_uri=https://client.example.com/callback&scope=openid email profile`;
```

### Token Exchange

Exchange the authorization code for access and ID tokens.

```ts title="auth.ts"
const response = await fetch(`${baseURL}/oauth2/token`, {
    method: "POST",
    headers: {
        "Content-Type": "application/x-www-form-urlencoded",
    },
    body: new URLSearchParams({
        grant_type: "authorization_code",
        code: authorizationCode,
        redirect_uri: "https://client.example.com/callback",
        client_id: "your_client_id",
        client_secret: "your_client_secret",
    }),
});
const tokens = await response.json();
```

## Advanced Configuration

### OIDC Metadata

Customize the OIDC metadata by providing a configuration object during initialization.

```ts title="auth.ts"
import { betterAuth } from "better-auth";
import { oidc } from "better-auth/plugins/oidc";

export const auth = betterAuth({
    plugins: [oidc({
        metadata: {
            issuer: "https://your-domain.com",
            authorization_endpoint: "/custom/oauth2/authorize",
            token_endpoint: "/custom/oauth2/token",
            // ...other custom metadata
        }
    })]
})
```

### JWKS Endpoint

Ensure clients can verify tokens by exposing the JWKS endpoint.

```ts title="server.ts"
import { auth } from "./auth";

app.get("/.well-known/jwks.json", (req, res) => {
    res.json(auth.api.getJWKS());
});
```

### Dynamic Client Registration

Enable dynamic client registration for automated client setup.

```ts title="auth.ts"
const auth = betterAuth({
    plugins: [oidc({
        allowDynamicClientRegistration: true,
    })]
})
```

## Schema

The OIDC Provider plugin adds the following tables to the database:

## Options

**allowDynamicClientRegistration**: `boolean` - Enable or disable dynamic client registration.  
**metadata**: `OIDCMetadata` - Customize the OIDC provider metadata.  
**generateClientId**: `() => string` - Function to generate client IDs.  
**generateClientSecret**: `() => string` - Function to generate client secrets.  
// ...existing code...

````
